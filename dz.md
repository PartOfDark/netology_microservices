# Домашнее задание: Микросервисы — принципы

## Задача 1: API Gateway

### Требования
- Маршрутизация запросов к нужному сервису на основе конфигурации
- Возможность проверки аутентификационной информации в запросах
- Обеспечение терминации HTTPS

---

### Сравнительная таблица API Gateway решений

| Характеристика                            | **Kong Gateway**              | **NGINX (OSS / Plus)**       | **Traefik**                  | **HAProxy**                  | **Amazon API Gateway**        |
|------------------------------------------|-------------------------------|------------------------------|------------------------------|------------------------------|-------------------------------|
| **Маршрутизация**                         | Да (на базе конфигурации)     | Да                            | Да                           | Да                           | Да                            |
| **Аутентификация (JWT/OAuth2)**          | Да (через плагины)            | Только через Lua/модули      | Да (через middleware)        | Только с внешними решениями  | Да                            |
| **HTTPS терминация**                      | Да                            | Да                            | Да                           | Да                           | Да                            |
| **Web UI / Панель управления**           | Да (Konga, Kong Manager)      | Нет (только конфиг)          | Да (Dashboard)               | Нет                          | Да                            |
| **Плагины и расширения**                  | Богатый набор плагинов        | Lua модули / NGINX Plus      | Middleware / плагины         | Lua scripts                  | Нет                           |
| **Поддержка сервис-меша**                | Да                            | Ограниченно                  | Да (с Istio, Consul и т.д.)  | Нет                          | Нет                           |
| **Производительность**                    | Высокая                       | Очень высокая                | Средняя-высокая              | Очень высокая                | Средняя                       |
| **Open Source / Enterprise**              | Да / Да                       | Да / Да                      | Да / Да                      | Да / Да                      | Только Enterprise             |
| **Развёртывание в Kubernetes**            | Да (Ingress Controller)       | Да                           | Да (native CRD support)      | Да                           | Нет                           |

---

### Выбор и обоснование

**Выбор:** `Kong Gateway`

**Плюсы:**
- Гибкая маршрутизация
- Готовые плагины для аутентификации (OAuth2, JWT, Rate Limiting)
- Поддержка HTTPS, сертификатов, LetsEncrypt
- Web UI (Konga, Kong Manager)
- Интеграция с Kubernetes
- Расширяемость (Lua, REST API для конфигурации)

---

## Задача 2: Брокер сообщений

### Требования
- Поддержка кластеризации
- Хранение сообщений на диске
- Высокая скорость работы
- Поддержка различных форматов сообщений
- Разделение прав доступа
- Простота эксплуатации

---

### Сравнительная таблица брокеров сообщений

| Характеристика                          | **Apache Kafka**             | **RabbitMQ**                 | **NATS (JetStream)**         | **Redis Streams**            | **Apache Pulsar**             |
|----------------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|-------------------------------|
| **Кластеризация**                      | Да (Zookeeper / KRaft)       | Да (через federation/cluster)| Да (JetStream)               | Да (Redis Cluster)           | Да (built-in)                 |
| **Хранение сообщений на диске**        | Да                           | Да                           | Да                           | Да                           | Да                            |
| **Пропускная способность**             | Очень высокая                | Средняя                      | Высокая                      | Средняя                      | Очень высокая                 |
| **Поддержка форматов (JSON/Avro/...)** | Да                           | Да                           | Да                           | Да                           | Да                            |
| **Управление правами доступа**         | Ограниченно (ACL)            | Да (гибкое)                  | Да (basic)                   | Да                           | Да (RBAC)                     |
| **Простота эксплуатации**              | Средняя                      | Высокая                      | Высокая                      | Высокая                      | Средняя                       |
| **Поддержка очередей / топиков**       | Топики                       | Очереди и топики             | Очереди и стримы             | Стримы                       | Очереди и топики              |
| **Latency**                            | <1 мс                        | <1 мс                        | <1 мс                        | <1 мс                        | <1 мс                         |

---

### Выбор и обоснование

**Выбор:** `RabbitMQ`

**Плюсы:**
- Поддержка кластеров и отказоустойчивости
- Гибкая маршрутизация
- Простота эксплуатации
- Широкая поддержка форматов и клиентов
- Расширяемая система авторизации

---

## Итоговое предложение

- **API Gateway:** Kong Gateway  
- **Message Broker:** RabbitMQ  

